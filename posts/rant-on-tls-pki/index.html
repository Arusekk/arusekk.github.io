<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Rant on TLS PKI | Arusekk blog</title>
<meta name="keywords" content="">
<meta name="description" content="There are some fundamental design flaws in X.509 / WebPKI (HTTPS/TLS key infrasructure), and I am freaked out nobody has noticed.  Or have they?">
<meta name="author" content="">
<link rel="canonical" href="/posts/rant-on-tls-pki/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/rant-on-tls-pki/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Rant on TLS PKI" />
<meta property="og:description" content="There are some fundamental design flaws in X.509 / WebPKI (HTTPS/TLS key infrasructure), and I am freaked out nobody has noticed.  Or have they?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/rant-on-tls-pki/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-21T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-07-21T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rant on TLS PKI"/>
<meta name="twitter:description" content="There are some fundamental design flaws in X.509 / WebPKI (HTTPS/TLS key infrasructure), and I am freaked out nobody has noticed.  Or have they?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Rant on TLS PKI",
      "item": "/posts/rant-on-tls-pki/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Rant on TLS PKI",
  "name": "Rant on TLS PKI",
  "description": "There are some fundamental design flaws in X.509 / WebPKI (HTTPS/TLS key infrasructure), and I am freaked out nobody has noticed.  Or have they?",
  "keywords": [
    
  ],
  "articleBody": "I like modern cryptography. I quite understand some bits of it, since I had an excellent university course on that, and while the rest feels pretty magic, these are my thoughts that should be understood by anyone.\nMy general opinion is that encryption is a mistake in most cases, but digital signatures make true sense to me, and I will focus on them.\nIf someone gives you much data, they know more than you. This is true especially for big integer numbers. Remember RSA? This is the (still widely used) encryption algorithm that assumes that while it is trivial to know n = pq when you know two primes p and q, it is really unlikely and/or computationally expensive to guess p and q from n.\nIf someone tells you n, you cannot tell at first whether they know p or q. You should assume that they might know more than you and thus be able to do extra mathematical operations.\nThis has been called several names, my favorite being ‚Äòbackdoored (or trapdoored) primes‚Äô.\nIf someone is unfair, they can pretend to be fair This costs them nothing. If they can decide whether to be fair or unfair, behaving fair does not mean anything. As all the stock exchanges repeat over and over: Past performance is not indicative of future results.\nIf many trust you, you are more trustworthy Remember not to treat it number-wise, though. I only mean that if people of set X trust you, you are strictly more trustworthy than someone trusted only by a strict subset of X.\nCurve25519 This is a cryptographic group derived from a nothing-up-my-sleeve number, and it has been widely suggested as a replacement for NIST‚Äôs P-256, which is at least a bit smelly.\nIt has been adopted by browsers for key exchange, but it still has no (browser) support in certificates, even though it is widely (for real, I mean widely) considered the best available asymmetric cryptographic system.\nSecurity Risk Ahead? I saw the website securityriskahead.eu when someone pasted a link to it on an IRC channel.\nIt talks many empty words about the EU (European Union) wanting to mandate QWACs (Qualified website authentication certificates, whatever that means) for websites.\nWhat I think they mean (nobody told me this! the entire text below is speculations of course: do your own research, because I did not have enough time for mine) is that the EU wants to sneak in a backdoor for the law enforcement to be able to do universal MITM (man-in-the-middle) attacks (i.e. impersonate any website you can think of, and therefore potentially steal your credentials). I will later explain how I arrived at this conclusion.\nThis is made possible by the fundamental design flaw in X.509 / WebPKI. What the draft law says is pretty much ‚Äôevery website must present a QWAC to EU citizens‚Äô. Which, in itself, should be harmless. You would get an extra guarantee from the QWAC (whatever it is) if you trust it, and if you don‚Äôt, it would just use some minor extra bandwidth.\nThe design flaw X.509 / WebPKI is a standard that specifies the format of certificate chains. It has been established by the CA/B (Certification Authority/Browser forum) tens of years ago. It mandates that every certificate is signed either by another certificate, or by itself. Self-signed certificates can be generated by anyone and therefore do not guarantee anything (like the n=pq example above), but assuming you trust their owners to only certify mindfully, it becomes a Trusted CA (Certification Authority). Every other certificate can be certified only by a single CA, which is fundamentally broken.\nThink of it as being able to only have one bank account (or e-mail account) at a time. The format simply does not have any way to express the fact that a single certificate is considered valid by both entity A and entity B. You have to choose either the former or the latter. This leads to monopolization, since if you are setting up a website, and you want to choose a CA, you choose one of those supported by all major browsers. You cannot combine one that is only supported by Firefox with a one that is supported only by Ghrome. So becoming a new CA involves convincing every single browser to add your cert to its root CA bundle (often called the root CA zoo), BEFORE you even get your first CSR (certificate signing request) from a potential client.\nHow it allows for sneaky MITM Since the EU wants every website to be verified by a QWAC (again, no matter what it actually is), the websites would have no option but to sign their certificates with a QWAC only. This in turn means that the browser vendors cannot revoke a QWAC if it is misused, because ‚Äútrusting it‚Äù is the only way to access the website. Or they can revoke it, but the QWAC that comes next is bound to be misused again in the same exact way.\nEither way, mandating QWACs sounds like a heavily bad idea, but it is only because of how utterly broken the X.509 / WebPKI format currently is.\n",
  "wordCount" : "860",
  "inLanguage": "en",
  "datePublished": "2022-07-21T00:00:00Z",
  "dateModified": "2022-07-21T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/rant-on-tls-pki/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Arusekk blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Arusekk blog (Alt + H)">Arusekk blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/pl/" title="üáµüá± PL"
                            aria-label=":flag_pl: PL">üáµüá± PL</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
            <li>
                <a href="/blogroll/" title="Blogroll">
                    <span>Blogroll</span>
                </a>
            </li>
            <li>
                <a href="/posts/index.xml" title="Feed">
                    <span>Feed</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Rant on TLS PKI
    </h1>
    <div class="post-description">
      There are some fundamental design flaws in X.509 / WebPKI (HTTPS/TLS key infrasructure), and I am freaked out nobody has noticed.  Or have they?
    </div>
    <div class="post-meta"><span title='2022-07-21 00:00:00 +0000 UTC'>July 21, 2022</span>&nbsp;¬∑&nbsp;5 min

</div>
  </header> 
  <div class="post-content"><p>I like modern cryptography.
I quite understand some bits of it,
since I had an excellent university course on that,
and while the rest feels pretty magic,
these are my thoughts that should be understood by anyone.</p>
<p>My general opinion is that <a href="/posts/overencryption-killing-interplanetary-networks/">encryption is a mistake in most cases</a>,
but digital signatures make true sense to me, and I will focus on them.</p>
<h2 id="if-someone-gives-you-much-data-they-know-more-than-you">If someone gives you much data, they know more than you.<a hidden class="anchor" aria-hidden="true" href="#if-someone-gives-you-much-data-they-know-more-than-you">#</a></h2>
<p>This is true especially for big integer numbers.
Remember RSA?
This is the (still widely used) encryption algorithm that assumes that while it is trivial to know
n = pq
when you know two primes p and q,
it is really unlikely and/or computationally expensive to guess p and q from n.</p>
<p>If someone tells you n, you cannot tell at first whether they know p or q.
You should assume that they might know more than you
and thus be able to do extra mathematical operations.</p>
<p>This has been called several names, my favorite being <a href="https://en.wikipedia.org/wiki/Nothing-up-my-sleeve_number#Counterexamples">&lsquo;backdoored (or trapdoored) primes&rsquo;</a>.</p>
<h2 id="if-someone-is-unfair-they-can-pretend-to-be-fair">If someone is unfair, they can pretend to be fair<a hidden class="anchor" aria-hidden="true" href="#if-someone-is-unfair-they-can-pretend-to-be-fair">#</a></h2>
<p>This costs them nothing.
If they can decide whether to be fair or unfair,
behaving fair does not mean anything.
As all the stock exchanges repeat over and over:
Past performance is not indicative of future results.</p>
<h2 id="if-many-trust-you-you-are-more-trustworthy">If many trust you, you are more trustworthy<a hidden class="anchor" aria-hidden="true" href="#if-many-trust-you-you-are-more-trustworthy">#</a></h2>
<p>Remember not to treat it number-wise, though.
I only mean that if people of set X trust you,
you are strictly more trustworthy
than someone trusted only by a strict subset of X.</p>
<h1 id="curve25519">Curve25519<a hidden class="anchor" aria-hidden="true" href="#curve25519">#</a></h1>
<p>This is a cryptographic group derived from a nothing-up-my-sleeve number,
and it has been widely suggested as a replacement for NIST&rsquo;s P-256,
which is at least a bit smelly.</p>
<p>It has been adopted by browsers for key exchange,
but it <a href="https://blog.pinterjann.is/ed25519-certificates.html">still has no (browser) support in certificates</a>,
even though it is widely (for real, I mean widely) considered
the best available asymmetric cryptographic system.</p>
<h1 id="security-risk-ahead">Security Risk Ahead?<a hidden class="anchor" aria-hidden="true" href="#security-risk-ahead">#</a></h1>
<p>I saw the website <a href="https://securityriskahead.eu/">securityriskahead.eu</a>
when someone pasted a link to it on an IRC channel.</p>
<p>It talks many empty words about the EU (European Union) wanting to mandate
QWACs (Qualified website authentication certificates, whatever that means)
for websites.</p>
<p><strong>What I think they mean</strong>
(nobody told me this!
the entire text below is speculations of course:
do your own research, because I did not have enough time for mine)
is that the EU wants
to sneak in a backdoor for the law enforcement
to be able to do universal MITM (man-in-the-middle) attacks
(i.e. impersonate any website you can think of,
and therefore potentially steal your credentials).
I will later explain how I arrived at this conclusion.</p>
<p>This is made possible by the fundamental design flaw in X.509 / WebPKI.
What the draft law says is pretty much &rsquo;every website must present a QWAC to EU citizens&rsquo;.
Which, in itself, should be harmless.
You would get an extra guarantee from the QWAC (whatever it is) if you trust it,
and if you don&rsquo;t, it would just use some minor extra bandwidth.</p>
<h1 id="the-design-flaw">The design flaw<a hidden class="anchor" aria-hidden="true" href="#the-design-flaw">#</a></h1>
<p>X.509 / WebPKI is a standard that specifies the format of certificate chains.
It has been established by the CA/B (Certification Authority/Browser forum)
tens of years ago.
It mandates that every certificate is signed either by another certificate,
or by itself.
Self-signed certificates can be generated by anyone
and therefore do not guarantee anything (like the n=pq example above),
but assuming you trust their owners to only certify mindfully,
it becomes a Trusted CA (Certification Authority).
Every other certificate can be certified only by a single CA,
which is fundamentally broken.</p>
<p>Think of it as being able to only have one bank account (or e-mail account) at a time.
The format simply does not have any way to express the fact that a single certificate
is considered valid by both entity A and entity B.
You have to choose either the former or the latter.
This leads to monopolization, since if you are setting up a website,
and you want to choose a CA, you choose one of those supported by all major browsers.
You cannot combine one that is only supported by Firefox
with a one that is supported only by Ghrome.
So becoming a new CA involves convincing every single browser
to add your cert to its root CA bundle (often called the root CA zoo),
BEFORE you even get your first CSR (certificate signing request) from a potential client.</p>
<h1 id="how-it-allows-for-sneaky-mitm">How it allows for sneaky MITM<a hidden class="anchor" aria-hidden="true" href="#how-it-allows-for-sneaky-mitm">#</a></h1>
<p>Since the EU wants every website to be verified by a QWAC (again, no matter what it actually is),
the websites would have no option but to sign their certificates with a QWAC <strong>only</strong>.
This in turn means that the browser vendors cannot revoke a QWAC if it is misused,
because &ldquo;trusting it&rdquo; is the only way to access the website.
Or they can revoke it,
but the QWAC that comes next is bound to be misused again in the same exact way.</p>
<p>Either way, mandating QWACs sounds like a heavily bad idea,
but it is only because of how utterly broken the X.509 / WebPKI format currently is.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="/">Arusekk blog</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
