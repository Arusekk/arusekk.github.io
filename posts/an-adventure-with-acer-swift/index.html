<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>An adventure with Acer Swift | Arusekk blog</title>
<meta name="keywords" content="">
<meta name="description" content="A story of a new laptop and hard obstacles in the way of getting it to work">
<meta name="author" content="">
<link rel="canonical" href="/posts/an-adventure-with-acer-swift/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/an-adventure-with-acer-swift/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="An adventure with Acer Swift" />
<meta property="og:description" content="A story of a new laptop and hard obstacles in the way of getting it to work" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/an-adventure-with-acer-swift/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-19T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="An adventure with Acer Swift"/>
<meta name="twitter:description" content="A story of a new laptop and hard obstacles in the way of getting it to work"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "An adventure with Acer Swift",
      "item": "/posts/an-adventure-with-acer-swift/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "An adventure with Acer Swift",
  "name": "An adventure with Acer Swift",
  "description": "A story of a new laptop and hard obstacles in the way of getting it to work",
  "keywords": [
    
  ],
  "articleBody": "Recently my old laptop started losing keyboard keys, and I heard that in 2021 it is time to let go of that good ol’ laptop with loud HDD, CD station, glossy HD-ready LCD, dissolved keys, cracked screws, two jacks, snappy sound, rumbling mic, 640x480 webcam, 4GiB RAM, 2x bithread i5-4200M @ 2.50 GHz, especially that I use unstable Gentoo GNU/Linux distro, which requires an overnight CPU-heavy update (Portage, the Gentoo PM, compiles everything from source by default).\nSo I bought a new one. I searched online for laptops with the following criteria set:\nwithout M$ Windows malware preinstalled, without Intel CPU, for no particular reason. (a linguistic digression):\n‘A laptop’ came from ‘a lap-top PC’, just as ‘a desktop’ came from ‘a desk-top PC’, and I am not willing to talk any ultrabook / hyperbook nonsense, though I like ’netbook’ as an analogy of a networking notepad. See I translated Git! for how hard it is to translate English nominalization of adjectives which is “business as usual”.\nThis narrowed down the search results to circa 30 distinct models. In whole Poland (see it for yourself).\nAnd then I thought that any would do, so I took the cheapest one. It happened to be Acer Swift 3 (SF314-42). It had quite everything I needed:\nA dedicated power socket. A USBC port, a USB2 port, and a USB3 port. A single jack audio socket. An HDMI socket. Light weight, full HD matt/frosted LCD (whatever the english name is). Sharp webcam, NVMe SSD, Ryzen 5, Radeon. The hardware drawbacks I saw then:\nNo RJ45 (LAN / Ethernet or what you call it). Intel Wi-Fi card (nah, it can’t be that bad). On the first boot an UEFI shell greeted me. A nice one, though the path separators were awfully backwards.\nThen I launched a live headless Gentoo to put everything in place. Or so I wanted to do. Before launching a screen appeared that wanted to know whether I wanted to install any special stuff inside my shiny new UEFI, so I just added the live OS’ bootloader, and it booted gracefully.\nI just set up Portage make.conf, timezone and locale, installed GRUB and genkernel, compiled a kernel with some preliminary config and the next step was to reboot. When I seleced gentoo-grub in EFI boot selection, it showed a huge red shield with a white cross on it and a label telling me “Secure Boot trust broken!” or something.\nThen I wanted to get it working, so just as the owner’s manual said, I went into BIOS (F2 on the logo), added a Supervisor password, added my bootloader’s hash into EFI trusted set, reset the password to empty in order to remove it (per the manual), and selected “Save \u0026 poweroff” or something.\nThen I tried to enter the BIOS again, but no luck this time :)\nIt looked just like it had a\nwhile (isPasswordSet \u0026\u0026 isPasswordUnset) {} somewhere, because the logo (normally present for ~a second) did not go away, and was unresponsive to Ctrl+Alt+Delete.\nThe good news was that my GRUB just worked. My GNU/Linux did not, I guess the kernel was not configured enough. So I took the universal config from Gentoo liveCD and started to throw things away.\nThe things that didn’t work OOTB were sound, X server, and touchpad. The touchpad still has a 0.001 chance to break @ boot for no reason.\nThe X server needed dri+amdgpu drivers enabled (no surprise here), The touchpad needed psmouse and some strange AMD I²C – SMBus bridge driver (no surprise either, but was hard to find pinctrl_amd, piix4_smbus and i2c_piix4 in Kconfig), the speakers worked with snd_hda_intel universal HD audio driver, and the mic apparently had a separate integrated soundcard (searching for ALC255 told me that, and it is snd_soc_dmic). The ax200 Wi-Fi 6 card needed iwlmvm with ax200 firmware blobs. Yeah, no chance to have 100% FLOSS on it now.\nBut whatever. The BIOS was still broken.\nI tried to boot to UEFI directly from Linux (I intentionally skipped GNU now, since it is a thin software from an answer to a SU question).\nI contacted Acer support on the phone, and the wisest thing they told me was to update BIOS, and they sent me a BIOS firmware update. It was a zipped EXE, so I started to look for lightweight live M$ Windows images. And not surprisingly I did not find one. Surprisingly though, I found that you can easily create one! All you need is another M$ Windows machine. I used my work laptop (shhh! don’t tell anyone) to create a 260 MiB iso image in as few as two obvious commands.\nEDIT: it turns out this is a known method and no Windows is needed\n(And I was in physical pain having to deal with this mirrored commandline.)\nI copied over only several files from inside the ISO to a USB stick (UEFI FTW over BIOS, no more reformatting your USB every single time!). It booted with no pain. And it launched the executable as well (great job, Insyde Corp!). But the executable told me that my BIOS is already up to date, and that I should go hack myself.\nSo I hacked that the FH4FR108.exe was a 7-zip SFX, extracted it, and finally saw that there is a file called properties.ini, which has tons of description on how to tamper with the parameters and e.g. disable the version check.\n(I lied, I searched online for H2OFFT-Wx64.exe and ended up on SU again).\nAnd it has worked! Now my shiny new laptop works again, without me having to install malware on it.\n",
  "wordCount" : "939",
  "inLanguage": "en",
  "datePublished": "2021-01-19T00:00:00Z",
  "dateModified": "2021-01-19T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/an-adventure-with-acer-swift/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Arusekk blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Arusekk blog (Alt + H)">Arusekk blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="/pl/" title="🇵🇱 PL"
                            aria-label=":flag_pl: PL">🇵🇱 PL</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
            <li>
                <a href="/blogroll/" title="Blogroll">
                    <span>Blogroll</span>
                </a>
            </li>
            <li>
                <a href="/posts/index.xml" title="Feed">
                    <span>Feed</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      An adventure with Acer Swift
    </h1>
    <div class="post-description">
      A story of a new laptop and hard obstacles in the way of getting it to work
    </div>
    <div class="post-meta"><span title='2021-01-19 00:00:00 +0000 UTC'>January 19, 2021</span>&nbsp;·&nbsp;5 min

</div>
  </header> 
  <div class="post-content"><p>Recently my old laptop started losing keyboard keys,
and I heard that in 2021 it is time to let go of that good ol&rsquo; laptop
with loud HDD, CD station, glossy HD-ready LCD, dissolved keys, cracked screws,
two jacks, snappy sound, rumbling mic, 640x480 webcam, 4GiB RAM,
2x bithread i5-4200M @ 2.50 GHz,
especially that I use unstable Gentoo GNU/Linux distro,
which requires an overnight CPU-heavy update
(Portage, the Gentoo PM, compiles everything from source by default).</p>
<p>So I bought a new one.
I searched online for laptops with the following criteria set:</p>
<ol>
<li>without M$ Windows <a href="https://www.gnu.org/proprietary/malware-microsoft.html">malware</a> preinstalled,</li>
<li>without Intel CPU, for no particular reason.</li>
</ol>
<p>(a linguistic digression):</p>
<p>&lsquo;A laptop&rsquo; came from &lsquo;a lap-top PC&rsquo;,
just as &lsquo;a desktop&rsquo; came from &lsquo;a desk-top PC&rsquo;,
and I am not willing to talk any ultrabook / hyperbook nonsense,
though I like &rsquo;netbook&rsquo; as an analogy of a networking notepad.
See <a href="/posts/i-translated-git/">I translated Git!</a> for how hard it is
to translate English nominalization of adjectives which is &ldquo;business as usual&rdquo;.</p>
<p>This narrowed down the search results to circa 30 distinct models.
In whole Poland (<a href="https://mediamarkt.pl/komputery-i-tablety/laptopy-laptopy-2-w-1./procesor=amd,amd-ryzen-3,amd-ryzen-5,amd-ryzen-7,amd-ryzen-9&system-operacyjny=brak-systemu">see</a> <a href="https://www.neonet.pl/komputery/laptopy/f/18176-rodzaj-procesora:amd-ryzen-5,amd-ryzen-7/8183-system-operacyjny:brak.html">it</a> <a href="https://www.euro.com.pl/laptopy-i-netbooki,rodzaj-procesora_3!amd,system-operacyjny_3!bez-systemu.bhtml">for</a> <a href="https://www.mediaexpert.pl/komputery-i-tablety/laptopy-i-ultrabooki/laptopy/system-operacyjny_chrome-os.brak-dos/procesor_amd-seria-e.amd-seria-a.amd-seria-3000.amd-ryzen-3.amd-ryzen-5.amd-ryzen-7.amd-ryzen-9.amd-ryzen-9-5900hx.amd-ryzen-7-5800h">yourself</a>).</p>
<p>And then I thought that any would do, so I took the cheapest one.
It happened to be Acer Swift 3 (SF314-42).
It had quite everything I needed:</p>
<ul>
<li>A dedicated power socket.</li>
<li>A USBC port, a USB2 port, and a USB3 port.</li>
<li>A single jack audio socket.</li>
<li>An HDMI socket.</li>
<li>Light weight, full HD matt/frosted LCD (whatever the english name is).</li>
<li>Sharp webcam, NVMe SSD, Ryzen 5, Radeon.</li>
</ul>
<p>The hardware drawbacks I saw then:</p>
<ul>
<li>No RJ45 (LAN / Ethernet or what you call it).</li>
<li>Intel Wi-Fi card (nah, it can&rsquo;t be that bad).</li>
</ul>
<p>On the first boot an UEFI shell greeted me.
A nice one, though the path separators were awfully backwards.</p>
<p>Then I launched a live headless Gentoo to put everything in place.
Or so I wanted to do.
Before launching a screen appeared that wanted to know
whether I wanted to install any special stuff inside my shiny new UEFI,
so I just added the live OS&rsquo; bootloader, and it booted gracefully.</p>
<p>I just set up Portage make.conf, timezone and locale,
installed GRUB and genkernel,
compiled a kernel with some preliminary config
and the next step was to reboot.
When I seleced gentoo-grub in EFI boot selection,
it showed a huge red shield with a white cross on it
and a label telling me &ldquo;Secure Boot trust broken!&rdquo; or something.</p>
<p>Then I wanted to get it working, so just as the owner&rsquo;s manual said,
I went into BIOS (F2 on the logo), added a Supervisor password,
added my bootloader&rsquo;s hash into EFI trusted set, reset the password
to empty in order to remove it (per the manual), and selected
&ldquo;Save &amp; poweroff&rdquo; or something.</p>
<p>Then I tried to enter the BIOS again, but no luck this time :)</p>
<p>It looked just like it had a</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (isPasswordSet <span style="color:#f92672">&amp;&amp;</span> isPasswordUnset) {}
</span></span></code></pre></div><p>somewhere, because the logo (normally present for ~a second) did not go away,
and was unresponsive to Ctrl+Alt+Delete.</p>
<p>The good news was that my GRUB just worked.
My GNU/Linux did not, I guess the kernel was not configured enough.
So I took the universal config from Gentoo liveCD
and started to throw things away.</p>
<p>The things that didn&rsquo;t work OOTB were sound, X server, and touchpad.
The touchpad still has a 0.001 chance to break @ boot for no reason.</p>
<p>The X server needed <code>dri</code>+<code>amdgpu</code> drivers enabled (no surprise here),
The touchpad needed psmouse and some strange AMD I²C – SMBus bridge driver
(no surprise either, but was hard to find <code>pinctrl_amd</code>,
<code>piix4_smbus</code> and <code>i2c_piix4</code> in Kconfig),
the speakers worked with <code>snd_hda_intel</code> universal HD audio driver,
and the mic apparently had a separate integrated soundcard
(searching for ALC255 told me that, and it is <code>snd_soc_dmic</code>).
The ax200 Wi-Fi 6 card needed <code>iwlmvm</code> with <code>ax200</code> firmware blobs.
Yeah, no chance to have 100% FLOSS on it now.</p>
<p>But whatever. The BIOS was still broken.</p>
<p>I tried to boot to UEFI directly from Linux (I intentionally skipped GNU now,
since it is a <a href="https://github.com/adoakley/efi-boot-to-fw-ui">thin software</a> from an <a href="https://superuser.com/a/1547985/400626">answer</a> to a <a href="https://superuser.com/questions/519718/linux-on-uefi-how-to-reboot-to-the-uefi-setup-screen-like-windows-8-can">SU question</a>).</p>
<p>I contacted Acer support on the phone, and the wisest thing they told me
was to update BIOS, and they sent me a BIOS firmware update.
It was a zipped EXE,
so I started to look for lightweight live M$ Windows images.
And not surprisingly I did not find one.
Surprisingly though, I found that you can <a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/download-winpe--windows-pe">easily create one</a>!
All you need is another M$ Windows machine.
I used my work laptop (shhh! don&rsquo;t tell anyone) to create a 260 MiB iso image
in as few as two obvious commands.</p>
<p>EDIT: it turns out this is a known method and <a href="https://wiki.archlinux.org/index.php/Windows_PE">no Windows is needed</a></p>
<p>(And I was in physical pain having to deal with this mirrored commandline.)</p>
<p>I copied over only several files from inside the ISO to a USB stick
(UEFI FTW over BIOS, no more reformatting your USB every single time!).
It booted with no pain.
And it launched the executable as well (great job, Insyde Corp!).
But the executable told me that my BIOS is already up to date,
and that I should go hack myself.</p>
<p>So I hacked that the <code>FH4FR108.exe</code> was a 7-zip SFX, extracted it,
and finally saw that there is a file called <code>properties.ini</code>,
which has tons of description on how to tamper with the parameters
and e.g. disable the version check.</p>
<p>(I lied, I searched online for <code>H2OFFT-Wx64.exe</code> and ended up on <a href="https://superuser.com/questions/1496286/how-to-repair-a-broken-bios-setup-utility">SU again</a>).</p>
<p>And it has worked!
Now my shiny new laptop works again, without me having to install malware on it.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="/">Arusekk blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
